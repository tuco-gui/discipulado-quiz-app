<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Show do Crentão — Sobrenatural Church</title>
  <meta name="color-scheme" content="dark">
  <style>
    :root{
      --bg:#000; --text:#fff; --muted:#cbd5e1;
      --green:#1bd39b; --green-deep:#12b37f;
      --white:#ffffff; --ink:#0b0f12;
      --panel:#050a0a; --panel-2:#071313; --border:#0c1f1d;

      /* distância dos botões à base na landing */
      --landing-pad-bottom: calc(12vh + env(safe-area-inset-bottom, 0px));
    }
    *{box-sizing:border-box}
    html,body{margin:0;min-height:100%;background:#000;color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial}

    /* ====== FUNDO (só na landing) ====== */
    body.landing-active{overflow:hidden} /* evita scroll acidental na primeira tela */

    body.landing-active::before{
      content:""; position:fixed; inset:0; z-index:-2;
      background:
        /* Removi escurecimento forte — cores mais vivas */
        linear-gradient(180deg,rgba(0,0,0,.06),rgba(0,0,0,.18)),
        url("img/cover.png") center / cover no-repeat;
      will-change: transform;
      transform-origin: 50% 30%;
      /* desktop/tablet: tamanho normal */
      transform: scale(1);
    }

    /* TELEFONE EM MODO RETRATO:
       - “diminui” a arte (mostra mais da cena)
       - desce levemente o foco no eixo Y
       - sobe os botões (mais longe da barra do navegador) */
    @media (max-aspect-ratio: 3/4){
      :root{ --landing-pad-bottom: calc(18vh + env(safe-area-inset-bottom, 0px)); }
      body.landing-active::before{
        background-position: center 42%;
        transform: scale(.86);        /* << reduzir o tamanho percebido do logo */
      }
    }
    /* telefones muito altos/estreitos (ex.: iPhone 13 mini/SE recente) */
    @media (max-width: 420px) and (max-aspect-ratio: 9/16){
      :root{ --landing-pad-bottom: calc(20vh + env(safe-area-inset-bottom, 0px)); }
      body.landing-active::before{
        background-position: center 40%;
        transform: scale(.82);        /* << reduz ainda mais */
      }
    }

    /* ====== LANDING: só os dois botões sobre a imagem ====== */
    .landing{
      position:fixed; inset:0; z-index:3;
      min-height: 100svh; /* iOS/Android novos */
      min-height: 100dvh; /* fallback novo */
      min-height: 100vh;  /* fallback geral   */
      display:flex; align-items:flex-end; justify-content:center;
      padding: 0 16px var(--landing-pad-bottom);
      transition:opacity .45s ease, transform .45s ease;
    }
    .landing.hide{opacity:0; transform:translateY(-8px); pointer-events:none}

    .cta{
      width: min(920px, 100%);
      display:grid; gap:18px; grid-template-columns:1fr 1fr;
    }
    @media (max-width:720px){
      .cta{ grid-template-columns: 1fr; gap:14px; }
    }

    .btn{
      appearance:none;border:0;cursor:pointer;border-radius:12px;
      font-weight:1000;letter-spacing:.02em;text-transform:uppercase;text-align:center;
      padding: clamp(14px, 3.8vw, 18px) clamp(16px, 4vw, 20px);
      font-size: clamp(1rem, 3.6vw, 1.4rem);
      transition:transform .06s ease, box-shadow .2s ease, filter .2s;
    }
    .btn.start{
      color:#02110c;
      background:linear-gradient(180deg,var(--green),var(--green-deep));
      box-shadow:0 6px 16px rgba(27,211,155,.28), inset 0 1px 0 rgba(255,255,255,.35);
      border:1px solid #10d49f
    }
    .btn.start:hover{filter:saturate(1.15) brightness(1.02)}
    .btn.start:active{transform:translateY(1px)}
    .btn.rank{
      color:var(--ink); background:var(--white);
      border:1px solid #dfe7e4; box-shadow:0 6px 16px rgba(255,255,255,.08)
    }
    .btn.rank:hover{box-shadow:0 0 0 3px rgba(255,255,255,.18), inset 0 1px 0 rgba(255,255,255,.45)}
    .btn.rank:active{transform:translateY(1px)}

    /* ====== APP ====== */
    header.appbar{
      position:sticky; top:0; z-index:2; padding:10px 16px;
      border-bottom:1px solid #0b1b19; background:rgba(0,0,0,.55); backdrop-filter:blur(6px);
      display:none; align-items:center; justify-content:space-between; gap:12px;
    }
    .app-started header.appbar{ display:flex; }
    .brand-left img{height:38px;object-fit:contain;filter:drop-shadow(0 0 2px rgba(255,255,255,.12))}
    .brand-right img{height:44px;object-fit:contain}

    main{max-width:1100px;margin:12px auto 64px;padding:18px 16px}
    .card{border:1px solid var(--border);border-radius:16px;background:var(--panel);padding:18px;box-shadow:0 10px 25px rgba(0,0,0,.55)}
    .grid{display:grid;gap:14px}
    .grid-2{display:grid;gap:12px;grid-template-columns:1fr}
    @media(min-width:760px){.grid-2{grid-template-columns:1fr 1fr}}
    .hidden{display:none !important}
    label{font-weight:800;display:block;margin:8px 0 6px}
    input[type="text"],input[type="tel"]{width:100%;background:#061010;color:#fff;border:1px solid #0c1f1d;border-radius:12px;padding:12px 14px;outline:none}
    input[type="text"]:focus,input[type="tel"]:focus{border-color:#164a42}
    .q{padding:14px;border:1px solid #0c1f1d;border-radius:12px;background:var(--panel-2)}
    .q-title{font-weight:900;margin-bottom:10px}
    .opt{display:grid;grid-template-columns:auto 1fr;gap:8px;margin:8px 0;align-items:start}
    .notice{padding:10px;border:1px solid #0c1f1d;border-radius:12px;background:#071313;margin-top:10px}
    .muted{color:var(--muted)}
    .center{text-align:center}
    .feedback{display:grid;place-items:center;min-height:110px;border:1px dashed #0c1f1d;border-radius:12px;background:#091515}
    .feedback.ok{border-color:#14532d;background:#052e16}
    .feedback.error{border-color:#7f1d1d;background:#2a1212}
    .fx{position:relative;overflow:hidden}
    .confetti{position:absolute;top:-10px;left:50%;width:6px;height:10px;background:#fff;animation:fall 1.5s linear infinite}
    @keyframes fall{0%{transform:translate(-50%,-10px) rotate(0)}100%{transform:translate(calc(-50% + (var(--x) * 1px)),130px) rotate(360deg)}}
    .rank-list{display:flex;flex-direction:column;gap:8px}
    .rank-item{display:grid;grid-template-columns:42px 1fr auto;gap:10px;align-items:center;padding:10px;border:1px solid #0c1f1d;border-radius:12px;background:#071313}
    .rank-pos{width:42px;height:42px;display:grid;place-items:center;background:#081716;border-radius:10px;border:1px solid #0f2a26}
    .score{font-weight:900}
  </style>
</head>
<body class="landing-active">
  <!-- APPBAR (aparece após clicar Iniciar/Ranking) -->
  <header class="appbar">
    <div class="brand-left"><img src="img/logo.png" alt="Sobrenatural Church" /></div>
    <div class="brand-right"><img src="img/logosc.png" alt="Show do Crentão" /></div>
  </header>

  <!-- LANDING -->
  <section id="landing" class="landing">
    <div class="cta">
      <button id="goParticipar" class="btn start">Iniciar</button>
      <button id="goRanking"   class="btn rank">Ranking</button>
    </div>
  </section>

  <main>
    <!-- CADASTRO -->
    <section id="screen-register" class="card grid hidden">
      <h2>Dados do participante</h2>
      <div><label for="nome">Nome completo</label><input id="nome" type="text" placeholder="Ex.: Maria Silva" autocomplete="name"></div>
      <div><label for="fone">Telefone (com DDD)</label><input id="fone" type="tel" placeholder="Ex.: (14) 99999-0000" autocomplete="tel"></div>
      <div class="notice muted">Cada pessoa pode responder <strong>uma única vez</strong>.</div>
      <div><button id="btnSendRegister" class="btn start">Enviar</button></div>
      <div id="msgRegister" class="notice hidden"></div>
    </section>

    <!-- QUIZ -->
    <section id="screen-quiz" class="card grid hidden">
      <div class="grid" id="quizStep"></div>
      <div id="quizMsg" class="notice hidden"></div>
    </section>

    <!-- RESULTADO -->
    <section id="screen-result" class="card grid hidden center">
      <h2>Resultado</h2>
      <p id="resultText" class="muted"></p>
      <div class="grid-2">
        <button id="btnVerRanking" class="btn rank">Ver Ranking</button>
        <button id="btnVoltarInicio" class="btn rank">Início</button>
      </div>
    </section>

    <!-- RANKING -->
    <section id="screen-ranking" class="card grid hidden">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:8px;">
        <h2 style="margin:0;">Ranking</h2>
        <button id="btnVoltarHome" class="btn rank">Voltar</button>
      </div>
      <div id="rankCount" class="muted"></div>
      <div id="rankList" class="rank-list"></div>
    </section>
  </main>

  <!-- ÁUDIOS -->
  <audio id="sfx-intro"        src="audio/silvio-santos-abertura-show-do-milhao.mp3" preload="auto" loop></audio>
  <audio id="sfx-pergunta"     src="audio/silvio-santos-voce-entendeu-a-pergunta.mp3"   preload="auto"></audio>
  <audio id="sfx-certeza"      src="audio/silvio-santos-voce-tem-certeza.mp3"           preload="auto"></audio>
  <audio id="sfx-esta-certo"   src="audio/silvio-santos-esta-certo-disso.mp3"           preload="auto"></audio>
  <audio id="sfx-qual-resposta"src="audio/silvio-santos-qual-e-a-resposta-certa.mp3"    preload="auto"></audio>
  <audio id="sfx-certa-resposta"src="audio/silvio-santos-certa-resposta.mp3"            preload="auto"></audio>
  <audio id="sfx-errou"        src="audio/faustao-errou.mp3"                             preload="auto"></audio>

  <script>
    /* ====== BASE / STORAGE ====== */
    const QUIZ_VERSION='v10-landing-mobile-tuned'; const STORAGE_KEY='discipulado_quiz_'+QUIZ_VERSION;
    const $ = id => document.getElementById(id);
    const normPhone = s => (s||'').replace(/\D+/g,'');
    const nowISO = () => { const d=new Date(), p=n=>String(n).padStart(2,'0'); return d.getFullYear()+'-'+p(d.getMonth()+1)+'-'+p(d.getDate())+' '+p(d.getHours())+':'+p(d.getMinutes()); };
    const titleCase = s => s.trim().replace(/\s+/g,' ').split(' ').map(w => (w[0]||'').toUpperCase()+w.slice(1).toLowerCase()).join(' ');
    function loadAll(){ try{ const raw=localStorage.getItem(STORAGE_KEY); return raw?JSON.parse(raw):{submissions:[]}; }catch(e){ return {submissions:[]};}}
    function saveAll(d){ localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); }
    function show(id){ ['screen-register','screen-quiz','screen-result','screen-ranking'].forEach(s=> $(s).classList.add('hidden')); $(id).classList.remove('hidden'); }

    /* ÁUDIO INTRO */
    const intro=$('sfx-intro');
    const startIntro=()=>{ try{ intro.currentTime=0; intro.play().catch(()=>{});}catch(e){} }
    const stopIntro =()=>{ try{ intro.pause(); intro.currentTime=0;}catch(e){} }

    function enterApp(next){
      const landing=$('landing');
      landing.classList.add('hide');
      document.body.classList.remove('landing-active');
      document.body.classList.add('app-started');
      setTimeout(()=>{ landing.style.display='none'; window.scrollTo({top:0, behavior:'instant'}); next(); }, 460);
    }

    $('goParticipar').addEventListener('click', ()=>{ startIntro(); enterApp(()=> show('screen-register'));});
    $('goRanking').addEventListener('click',   ()=>{ stopIntro();  enterApp(()=>{ renderRanking(); show('screen-ranking');});});

    function setMsg(el, text, type){ el.textContent=text; el.className='notice ' + (type||''); el.classList.remove('hidden'); }
    function clearMsg(el){ el.classList.add('hidden'); el.textContent=''; }

    /* CADASTRO */
    $('btnSendRegister').addEventListener('click', ()=>{
      const name=titleCase(($('nome').value||'')); const phoneRaw=normPhone(($('fone').value||'')); const box=$('msgRegister'); clearMsg(box);
      if(!name||name.length<3) return setMsg(box,'Informe seu nome completo.','warn');
      if(!phoneRaw||phoneRaw.length<10) return setMsg(box,'Informe um telefone válido com DDD.','warn');
      const all=loadAll();
      if(all.submissions.some(s=>s.name.toLowerCase()===name.toLowerCase() && s.phone===phoneRaw))
        return setMsg(box,'Você já respondeu este quiz e não pode responder novamente.','error');
      stopIntro(); // para música ao enviar
      sessionStorage.setItem('quiz_participant', JSON.stringify({name, phone:phoneRaw, startedAt:nowISO()}));
      quizState.index=0; quizState.correct=0; quizState.selected=null;
      renderCurrentQuestion(); show('screen-quiz'); window.scrollTo({top:0, behavior:'instant'});
    });

    /* QUIZ */
    const QUESTIONS=[
      {title:"O que caracteriza a obediência imediata?",
       options:["Agir após confirmar com outras pessoas.","Responder sem demora ao que Deus ordena.","Esperar o momento mais conveniente.","Agir somente quando tudo estiver claro."],correctIndex:1},
      {title:"O que é fé genuína segundo o estudo?",
       options:["Fé baseada no testemunho de outras pessoas.","Fé emocional despertada em um culto.","Fé verdadeira e pessoal, que cresce com exercício.","Fé herdada de familiares."],correctIndex:2},
      {title:"Quais são os quatro aspectos que transformaram Abraão em Pai da Fé?",
       options:["Obediência imediata, obediência parcial, fé genuína, perseverança.","Obediência imediata, obediência total, fé genuína, perseverança.","Obediência, oração, jejum, perseverança.","Obediência total, milagres, fé emprestada, perseverança."],correctIndex:1},
      {title:"Qual é a importância de testemunhar as obras de Deus?",
       options:["Tornar-se mais conhecido na igreja.","Inspirar e fortalecer a fé de outros.","Cumprir uma obrigação religiosa.","Garantir bênçãos futuras."],correctIndex:1}
    ];
    const quizState={index:0, correct:0, selected:null};

    function renderCurrentQuestion(){
      stopIntro();
      const step=$('quizStep'); step.innerHTML='';
      const q=QUESTIONS[quizState.index];
      const wrap=document.createElement('div'); wrap.className='grid';
      const title=document.createElement('div'); title.className='q-title'; title.textContent=`Pergunta ${quizState.index+1} de ${QUESTIONS.length}: `+q.title;
      const qsBox=document.createElement('div'); qsBox.className='q';
      q.options.forEach((opt,oi)=>{ const lbl=document.createElement('label'); lbl.className='opt';
        const inp=document.createElement('input'); inp.type='radio'; inp.name='alt'; inp.value=oi; inp.addEventListener('change',()=> quizState.selected=oi);
        const span=document.createElement('span'); span.textContent=opt; lbl.appendChild(inp); lbl.appendChild(span); qsBox.appendChild(lbl); });
      const row=document.createElement('div'); row.className='grid-2';
      const btnEnviar=document.createElement('button'); btnEnviar.className='btn start'; btnEnviar.textContent='Enviar';
      const btnLimpar=document.createElement('button'); btnLimpar.className='btn rank'; btnLimpar.textContent='Limpar';
      row.appendChild(btnEnviar); row.appendChild(btnLimpar);
      const fb=document.createElement('div'); fb.id='feedback'; fb.className='feedback hidden fx';
      wrap.appendChild(title); wrap.appendChild(qsBox); wrap.appendChild(row); wrap.appendChild(fb); step.appendChild(wrap);
      btnLimpar.addEventListener('click',()=>{ quizState.selected=null; qsBox.querySelectorAll('input[type=radio]').forEach(r=> r.checked=false); });
      btnEnviar.addEventListener('click',()=>{ if(quizState.selected===null){ fb.className='notice'; fb.textContent='Selecione uma alternativa antes de enviar.'; fb.classList.remove('hidden'); return;}
        askConfirmation(fb, ()=> evaluateAnswer(fb)); });
      playOne(['sfx-pergunta']); window.scrollTo({top:0, behavior:'instant'});
    }

    function askConfirmation(container,onConfirm){
      playOne(Math.random()<0.5?['sfx-certeza']:['sfx-esta-certo']);
      container.className='feedback fx'; container.innerHTML='';
      const p=document.createElement('div'); p.style.fontWeight='900'; p.textContent='Você tem certeza da resposta?';
      const row=document.createElement('div'); row.className='grid-2';
      const btnConf=document.createElement('button'); btnConf.className='btn start'; btnConf.textContent='Confirmar';
      const btnCanc=document.createElement('button'); btnCanc.className='btn rank'; btnCanc.textContent='Cancelar';
      row.appendChild(btnConf); row.appendChild(btnCanc); container.appendChild(p); container.appendChild(row); container.classList.remove('hidden');
      btnConf.addEventListener('click',onConfirm); btnCanc.addEventListener('click',()=>{container.classList.add('hidden');container.innerHTML='';});
    }

    function simpleConfetti(container){
      for(let i=0;i<22;i++){ const c=document.createElement('div'); c.className='confetti'; c.style.left='50%'; c.style.setProperty('--x',(Math.random()*200-100).toFixed(0));
        c.style.background=`hsl(${Math.floor(Math.random()*360)},100%,70%)`; c.style.animationDuration=(1+Math.random()*0.8).toFixed(2)+'s';
        container.appendChild(c); setTimeout(()=> c.remove(),1700); }
    }
    function evaluateAnswer(fb){
      const q=QUESTIONS[quizState.index]; const ok=(quizState.selected===q.correctIndex);
      if(ok){ quizState.correct++; fb.className='feedback ok fx'; fb.textContent='Certa resposta!'; playOne(['sfx-certa-resposta']); simpleConfetti(fb); }
      else { fb.className='feedback error'; fb.textContent='Resposta errada!'; playOne(['sfx-errou']); }
      setTimeout(()=>{ quizState.selected=null; if(quizState.index<QUESTIONS.length-1){ quizState.index++; renderCurrentQuestion(); } else { finishQuiz(); } },2000);
    }
    function playOne(ids){ try{ ids.forEach(id=>{ const el=document.getElementById(id); if(el){ el.currentTime=0; el.play().catch(()=>{});} }); }catch(e){} }

    function finishQuiz(){
      const part=JSON.parse(sessionStorage.getItem('quiz_participant')||'null'); if(!part){ show('screen-register'); return; }
      const store=loadAll();
      if(store.submissions.some(s=>s.name.toLowerCase()===part.name.toLowerCase() && s.phone===part.phone)){ show('screen-register'); return; }
      const item={name:part.name, phone:part.phone, score:quizState.correct, total:QUESTIONS.length, timestamp:nowISO()};
      store.submissions.push(item); saveAll(store);
      document.getElementById('resultText').textContent=`Sua nota: ${quizState.correct}/${QUESTIONS.length}`;
      show('screen-result'); sessionStorage.removeItem('quiz_participant'); window.scrollTo({top:0, behavior:'instant'});
    }

    /* RANKING */
    function renderRanking(){
      const list=document.getElementById('rankList'); const count=document.getElementById('rankCount');
      const data=[...loadAll().submissions];
      data.sort((a,b)=> b.score - a.score || a.timestamp.localeCompare(b.timestamp));
      count.textContent=data.length?`Total de participantes: ${data.length}`:'Sem participantes.';
      if(!data.length){ list.innerHTML='<div class="muted">Sem envios ainda.</div>'; return; }
      list.innerHTML=data.map((r,i)=>`<div class="rank-item">
        <div class="rank-pos">${i+1}</div>
        <div><div style="font-weight:900">${r.name}</div><div class="muted">${maskPhone(r.phone)} · ${r.timestamp}</div></div>
        <div class="score">${r.score}/${r.total}</div>
      </div>`).join('');
      window.scrollTo({top:0, behavior:'instant'});
    }
    function maskPhone(p){ const d=(p||'').replace(/\D+/g,''); if(d.length<10) return p;
      return d.length===11?`(${d.slice(0,2)}) ${d.slice(2,7)}-${d.slice(7)}`:`(${d.slice(0,2)}) ${d.slice(2,6)}-${d.slice(6)}`; }

    document.getElementById('btnVerRanking').addEventListener('click',()=>{ renderRanking(); show('screen-ranking'); });
    document.getElementById('btnVoltarInicio').addEventListener('click',()=> location.reload());
    document.getElementById('btnVoltarHome').addEventListener('click',()=> location.reload());
  </script>
</body>
</html>
