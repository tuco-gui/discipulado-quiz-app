<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Show do Crentão — Sobrenatural Church</title>
  <meta name="theme-color" content="#000000" />
  <style>
    :root{
      --bg:#000; --green:#1fddac; --green-700:#0fa17e; --white:#ffffff;
      --card:#0c0f0f; --muted:#aab3b1; --radius:14px;
      --shadow:0 12px 40px rgba(0,0,0,.45); --shadow-soft:0 8px 20px rgba(0,0,0,.35);
      --pad: clamp(16px, 3vw, 28px); --maxw: 1040px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;background:#000;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial}
    img{display:block;max-width:100%}
    .hidden{display:none !important}

    /* HEADER */
    header{
      position:fixed; inset:0 0 auto 0; height:56px;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 var(--pad); z-index:40; pointer-events:none;
      background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,0));
    }
    .brand, .right{pointer-events:auto; display:flex; align-items:center; gap:12px;}
    .brand img{height:22px; opacity:.95}
    .title-logo{height:26px; opacity:.96; filter: drop-shadow(0 2px 8px rgba(0,0,0,.45)); display:none;}
    @media (max-width:768px){ .title-logo{height:22px;} }

    /* HERO */
    #hero{
      position:relative; min-height:100svh;
      display:flex; align-items:flex-end; justify-content:center;
      padding: calc(56px + 10svh) var(--pad) calc(20svh);
      background:#000; overflow:hidden;
      opacity:1; transform:none;
    }
    #hero .bg{ position:absolute; inset:0; z-index:0; display:grid; place-items:center;}
    #heroImg{ width:100%; height:100%; object-fit:cover; user-select:none; -webkit-user-drag:none; filter:none; }
    @media (max-width: 768px){
      #hero{padding: calc(56px + 6svh) var(--pad) calc(18svh);}
      #heroImg{ object-fit:contain; aspect-ratio:auto; object-position: center 70px; }
    }
    #hero .cta{ position:relative; z-index:2; width:100%; max-width: min(780px, 92vw); display:flex; gap:14px; flex-wrap:wrap; justify-content:center; }

    .btn{
      appearance:none; border:0; border-radius:18px; padding:18px 28px;
      font-weight:800; letter-spacing:.02em; text-transform:uppercase; cursor:pointer;
      box-shadow: var(--shadow);
      transition: transform .08s ease, box-shadow .2s ease, opacity .2s ease, filter .2s ease;
      will-change: transform;
    }
    .btn:active{transform: translateY(1px); box-shadow: var(--shadow-soft);}
    .btn.primary{ background:linear-gradient(180deg, var(--green) 0%, var(--green-700) 100%); color:#06261f; }
    .btn.secondary{ background:var(--white); color:#0a0d0c }
    .btn.full{ flex:1 1 320px; }

    /* CONTEÚDO */
    main{display:grid; gap:28px; padding:24px var(--pad) 48px; max-width:var(--maxw); margin:0 auto}
    .card{
      background:rgba(12,15,15,.72); backdrop-filter: blur(6px);
      border:1px solid rgba(255,255,255,.06); border-radius:var(--radius);
      box-shadow:var(--shadow); padding: min(28px, 3.2vw);
    }
    h2{margin:0 0 14px; font-size:22px}
    label{display:block; font-size:14px; margin:14px 0 6px; color:#cdd5d3}
    input[type="text"], input[type="tel"]{
      width:100%; padding:14px 16px; border-radius:12px; border:1px solid rgba(255,255,255,.08);
      background:#0b0f0e; color:#fff; outline:none;
    }
    .help{font-size:13px; color:#93a29f; margin-top:10px}
    .row{display:flex; gap:12px; flex-wrap:wrap}
    .row .btn{min-width:180px}
    #section-form, #section-quiz, #section-ranking{display:none}

    /* CONFIRMAÇÃO */
    .confirm-box{ margin-top:14px; padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,.08); background:#0a0f0f; }
    .confirm-title{font-weight:800; margin-bottom:10px;}

    /* FX VISUAIS */
    #fxOverlay{ position:fixed; inset:0; pointer-events:none; z-index:60; }
    .fx-ok::after{
      content:""; position:absolute; inset:0; margin:auto;
      width:min(55vmin,520px); height:min(55vmin,520px);
      border-radius:50%;
      background:radial-gradient(ellipse at center, rgba(31,221,172,.28), rgba(31,221,172,0) 60%);
      animation:okPulse .95s ease-out forwards;
    }
    @keyframes okPulse{ 0%{transform:scale(.7); opacity:.0} 25%{opacity:.9} 100%{transform:scale(1.15); opacity:0} }
    .fx-wrong{ animation:shake .6s ease-in-out 0s 1; }
    .fx-wrong::after{
      content:""; position:absolute; inset:0;
      background:radial-gradient(ellipse at center, rgba(242,78,58,.18), rgba(242,78,58,0) 65%);
      animation:fadeOut .8s ease forwards;
    }
    @keyframes shake{
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-10px)} 40%{transform:translateX(10px)}
      60%{transform:translateX(-6px)} 80%{transform:translateX(6px)}
    }
    @keyframes fadeOut{ from{opacity:.9} to{opacity:0} }
  </style>
</head>
<body>

  <!-- topo -->
  <header>
    <div class="brand">
      <img src="img/logo.png" alt="Sobrenatural Church" onerror="this.style.display='none'">
    </div>
    <div class="right">
      <img id="crentaoLogo" class="title-logo" alt="Show do Crentão" />
    </div>
  </header>

  <!-- PRIMEIRA TELA -->
  <section id="hero">
    <div class="bg">
      <img id="heroImg" alt="Capa – Show do Crentão" class="hidden">
    </div>
    <div class="cta">
      <button id="btnStart" class="btn primary full">Iniciar</button>
      <button id="btnRanking" class="btn secondary full">Ranking</button>
    </div>
  </section>

  <!-- CONTEÚDOS -->
  <main>
    <section id="section-form" class="card">
      <h2>Dados do participante</h2>
      <label>Nome completo</label>
      <input id="nome" type="text" placeholder="Ex.: Maria Silva">
      <label>Telefone (com DDD)</label>
      <input id="fone" type="tel" placeholder="Ex.: (14) 99999-0000">
      <div class="help">Cada pessoa pode responder <strong>uma única vez</strong>.</div>
      <div class="row" style="margin-top:16px">
        <button id="btnEnviarDados" class="btn primary">Enviar</button>
      </div>
    </section>

    <section id="section-quiz" class="card">
      <h2 id="quizPergunta">Pergunta</h2>
      <div id="quizOpcoes"></div>

      <div id="confirmBox" class="confirm-box hidden">
        <div class="confirm-title">Você tem certeza da resposta?</div>
        <div class="row">
          <button id="btnConfirmar" class="btn primary">Confirmar</button>
        </div>
      </div>

      <div class="row" id="actionRow" style="margin-top:16px">
        <button id="btnResponder" class="btn primary">Enviar</button>
        <button id="btnLimpar" class="btn secondary">Limpar</button>
      </div>

      <audio id="fxCerteza"      src="audio/silvio-santos-voce-tem-certeza.mp3" preload="auto"></audio>
      <audio id="fxEntendeu"     src="audio/silvio-santos-voce-entendeu-a-pergunta.mp3" preload="auto"></audio>
      <audio id="fxEstaCerto"    src="audio/silvio-santos-esta-certo-disso.mp3" preload="auto"></audio>
      <audio id="fxQualResposta" src="audio/silvio-santos-qual-e-a-resposta-certa.mp3" preload="auto"></audio>
      <audio id="fxCertaResposta"src="audio/silvio-santos-certa-resposta.mp3" preload="auto"></audio>
      <audio id="fxErrou"        src="audio/faustao-errou.mp3" preload="auto"></audio>
      <audio id="fxAbertura"     src="audio/silvio-santos-abertura-show-do-milhao.mp3" preload="auto" loop></audio>
    </section>

    <section id="section-ranking" class="card">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
        <h2>Ranking</h2>
        <button id="btnResetDev" class="btn secondary hidden" title="Apenas no modo dev">Limpar ranking (DEV)</button>
      </div>
      <div id="rankingLista" class="help">Sem participantes por enquanto.</div>
      <div class="row" style="margin-top:16px">
        <button id="btnVoltar" class="btn secondary">Voltar</button>
      </div>
    </section>
  </main>

  <div id="fxOverlay" aria-hidden="true"></div>

<script>
(function(){
  /* ---------- refs ---------- */
  const hero = document.getElementById('hero');
  const heroImg = document.getElementById('heroImg');
  const crentaoLogo = document.getElementById('crentaoLogo');
  const fxOverlay = document.getElementById('fxOverlay');

  const fxAbertura     = document.getElementById('fxAbertura');
  const fxCerteza      = document.getElementById('fxCerteza');
  const fxEntendeu     = document.getElementById('fxEntendeu');
  const fxEstaCerto    = document.getElementById('fxEstaCerto');
  const fxQualResposta = document.getElementById('fxQualResposta');
  const fxCerta        = document.getElementById('fxCertaResposta');
  const fxErrou        = document.getElementById('fxErrou');

  const canPlay = a => { try { a.currentTime=0; a.play().catch(()=>{}); } catch(e){} };
  const stop = a => { try { a.pause(); a.currentTime=0; } catch(e){} };
  const stopAllFx = ()=>[fxAbertura,fxCerteza,fxEntendeu,fxEstaCerto,fxQualResposta,fxCerta,fxErrou].forEach(stop);

  const secForm = document.getElementById('section-form');
  const secQuiz = document.getElementById('section-quiz');
  const secRank = document.getElementById('section-ranking');

  const btnStart   = document.getElementById('btnStart');
  const btnRanking = document.getElementById('btnRanking');
  const btnVoltar  = document.getElementById('btnVoltar');

  /* ---------- helpers ---------- */
  function playAndWait(audio){
    return new Promise(resolve=>{
      try{
        audio.currentTime = 0;
        const onEnd = ()=>{ audio.removeEventListener('ended', onEnd); resolve(); };
        audio.addEventListener('ended', onEnd);
        audio.play().catch(()=>resolve());
      }catch(e){ resolve(); }
    });
  }
  function showFx(type){
    return new Promise(resolve=>{
      const cls = type === 'ok' ? 'fx-ok' : 'fx-wrong';
      fxOverlay.classList.add(cls);
      setTimeout(()=>{ fxOverlay.classList.remove(cls); resolve(); }, type === 'ok' ? 950 : 800);
    });
  }
  function testaImagem(src){
    return new Promise(resolve=>{
      const i = new Image();
      i.onload = ()=>resolve(true);
      i.onerror = ()=>resolve(false);
      i.src = src + '?v=' + Date.now();
    });
  }
  function hideAll(){ secForm.style.display='none'; secQuiz.style.display='none'; secRank.style.display='none'; }
  function toggleLogo(show){ crentaoLogo.style.display = show ? '' : 'none'; }
  function goHome(){
    // volta para a capa
    hideAll();
    stopAllFx();
    toggleLogo(false);
    hero.style.display='block';
    // reseta efeito de fade usado na transição
    hero.style.opacity='1';
    hero.style.transform='none';
  }

  /* ---------- logo do topo (usa exatamente img/logosc.png) ---------- */
  (async function carregaLogo(){
    const path = 'img/logosc.png';
    const ok = await testaImagem(path);
    if (ok) crentaoLogo.src = path;
  })();

  /* ---------- capa do hero ---------- */
  const capaCandidates = [
    'img/cover.png','img/cover.jpg','img/cover.webp','img/capa.png','img/capa.jpg',
    'img/show-crentao-bg.png','img/show-crentao-bg.jpg','img/logosc.png'
  ];
  (async function acharCapa(){
    for (const src of capaCandidates){
      const ok = await testaImagem(src);
      if (ok){ heroImg.src = src; heroImg.classList.remove('hidden'); return; }
    }
    hero.style.background = '#000';
  })();

  /* ---------- navegação ---------- */
  btnStart.addEventListener('click', ()=>{
    canPlay(fxAbertura);
    hero.style.transition = 'transform .35s ease, opacity .35s ease';
    hero.style.transform  = 'translateY(-8px)';
    hero.style.opacity    = '0';
    setTimeout(()=>{ hero.style.display='none'; hideAll(); toggleLogo(false); secForm.style.display='block'; }, 360);
  });

  btnRanking.addEventListener('click', ()=>{
    stopAllFx();
    hero.style.transition = 'transform .35s ease, opacity .35s ease';
    hero.style.transform  = 'translateY(-8px)';
    hero.style.opacity    = '0';
    setTimeout(()=>{ hero.style.display='none'; hideAll(); toggleLogo(true); secRank.style.display='block'; renderRanking(); }, 360);
  });

  // agora volta pra HOME/capa
  btnVoltar.addEventListener('click', goHome);

  /* ---------- storage + form ---------- */
  const nome = document.getElementById('nome');
  const fone = document.getElementById('fone');
  const btnEnviarDados = document.getElementById('btnEnviarDados');

  const LS = {
    get: (k,def)=>{ try{ return JSON.parse(localStorage.getItem(k)) ?? def }catch(_){return def} },
    set: (k,v)=>localStorage.setItem(k, JSON.stringify(v)),
    del: (k)=>localStorage.removeItem(k)
  };

  let participanteAtual = null;

  btnEnviarDados.addEventListener('click', ()=>{
    const n = (nome.value||'').trim();
    const f = (fone.value||'').trim();
    if(!n || !f){ alert('Preencha nome e telefone.'); return; }
    const ja = LS.get('respondidos', {});
    if(ja[f]){ alert('Este telefone já respondeu.'); return; }
    ja[f] = { nome:n, quando: Date.now() };
    LS.set('respondidos', ja);
    participanteAtual = { nome:n, fone:f };
    stop(fxAbertura);
    iniciarQuiz();
  });

  /* ---------- quiz ---------- */
  const perguntas = [
    { enunciado:"O que é fé genuína segundo o estudo?",
      opcoes:["Fé baseada no testemunho de outras pessoas.","Fé emocional despertada em um culto.","Fé verdadeira e pessoal, que cresce com exercício.","Fé herdada de familiares."],
      certa:2 },
    { enunciado:"Qual foi o primeiro aspecto importante na vida de Abraão?",
      opcoes:["Obediência imediata","Caridade","Riqueza","Fama"],
      certa:0 },
    { enunciado:"A obediência, segundo a aula, é sobretudo…",
      opcoes:["um ato de submissão cega.","uma expressão de amor e confiança em Deus.","uma tradição da igreja.","uma estratégia para evitar problemas."],
      certa:1 },
    { enunciado:"Qual é a característica primordial do cristão destacada na aula?",
      opcoes:["Popularidade","Prosperidade","Perseverança","Carisma"],
      certa:2 }
  ];

  let idx = 0, escolha = null, acertos = 0;

  const elPerg     = document.getElementById('quizPergunta');
  const elOps      = document.getElementById('quizOpcoes');
  const actionRow  = document.getElementById('actionRow');
  const btnResp    = document.getElementById('btnResponder');
  const btnLimpar  = document.getElementById('btnLimpar');
  const confirmBox = document.getElementById('confirmBox');
  const btnConf    = document.getElementById('btnConfirmar');

  function showActions(){ actionRow.classList.remove('hidden'); confirmBox.classList.add('hidden'); }
  function showConfirm(){ actionRow.classList.add('hidden'); confirmBox.classList.remove('hidden'); }

  function iniciarQuiz(){
    hideAll(); secQuiz.style.display='block'; toggleLogo(true);
    idx = 0; escolha = null; acertos = 0;
    canPlay(fxEntendeu);
    renderPergunta();
  }

  function renderPergunta(){
    const p = perguntas[idx];
    elPerg.textContent = `Pergunta ${idx+1} de ${perguntas.length}: ${p.enunciado}`;
    elOps.innerHTML = '';
    showActions();

    p.opcoes.forEach((txt,i)=>{
      const li = document.createElement('label');
      li.style.cssText='display:flex;gap:10px;align-items:center;margin:10px 0';
      li.innerHTML = `<input type="radio" name="op" value="${i}" /> <span>${txt}</span>`;
      elOps.appendChild(li);
    });
    elOps.querySelectorAll('input[name=op]').forEach(r=>r.addEventListener('change',()=>{ escolha=+r.value; }));
  }

  // rodízio de áudios
  const confirmAudios = [fxCerteza, fxEstaCerto, fxQualResposta];

  btnResp.addEventListener('click', ()=>{
    if(escolha===null){ canPlay(fxCerteza); return; }
    showConfirm(); stopAllFx();
    canPlay( confirmAudios[idx % confirmAudios.length] );
  });

  btnConf.addEventListener('click', async ()=>{
    stopAllFx();
    const ok = (escolha === perguntas[idx].certa);
    if(ok){ acertos++; await Promise.all([playAndWait(fxCerta), showFx('ok')]); }
    else  { await Promise.all([playAndWait(fxErrou),  showFx('wrong')]); }

    idx++; escolha=null;
    if(idx < perguntas.length){ renderPergunta(); canPlay(fxEntendeu); }
    else { finalizar(); }
  });

  btnLimpar.addEventListener('click', ()=>{
    elOps.querySelectorAll('input[name=op]').forEach(r=>r.checked=false);
    escolha=null;
  });

  /* ---------- ranking ---------- */
  function finalizar(){
    const rank = LS.get('ranking', []);
    rank.push({ nome: participanteAtual.nome, fone: participanteAtual.fone, pontos: Number(acertos)||0, quando: Date.now() });
    rank.sort((a,b)=> b.pontos - a.pontos || a.quando - b.quando);
    LS.set('ranking', rank);
    hideAll(); toggleLogo(true); secRank.style.display='block'; renderRanking();
  }
  function renderRanking(){
    const rank = LS.get('ranking', []);
    const box = document.getElementById('rankingLista');
    if(!rank.length){ box.textContent = 'Sem participantes por enquanto.'; return; }
    const linhas = rank.map((r,i)=> `${i+1}. ${r.nome} — ${r.fone} — ${r.pontos} ponto(s)`);
    box.innerHTML = linhas.map(l=>`<div style="padding:6px 0;border-bottom:1px solid rgba(255,255,255,.06)">${l}</div>`).join('');
  }

  /* ---------- DEV reset ---------- */
  const btnResetDev = document.getElementById('btnResetDev');
  if (location.hash === '#dev') {
    btnResetDev.classList.remove('hidden');
    btnResetDev.addEventListener('click', ()=>{
      if (confirm('Apagar todos os resultados do ranking neste navegador?')) {
        LS.del('ranking'); LS.del('respondidos'); renderRanking();
        alert('Ranking limpo (apenas neste navegador).');
      }
    });
  }
})();
</script>
</body>
</html>
