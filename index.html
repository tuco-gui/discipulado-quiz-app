<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Show do Crentão — Sobrenatural Church</title>
  <meta name="theme-color" content="#000000" />
  <style>
    :root{
      --bg:#000;
      --green:#1fddac;
      --green-700:#0fa17e;
      --white:#ffffff;
      --card:#0c0f0f;
      --muted:#aab3b1;
      --radius:14px;
      --shadow:0 12px 40px rgba(0,0,0,.45);
      --shadow-soft:0 8px 20px rgba(0,0,0,.35);
      --pad: clamp(16px, 3vw, 28px);
      --maxw: 1040px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;background:#000;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial}
    a{color:inherit}
    img{display:block;max-width:100%}
    .hidden{display:none !important}

    /* -------------------- HEADER -------------------- */
    header{
      position:fixed; inset:0 0 auto 0; height:56px;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 var(--pad);
      z-index:40; pointer-events:none;
      background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,0));
    }
    .brand, .title{pointer-events:auto; display:flex; align-items:center; gap:12px;}
    .brand img{height:22px; opacity:.95}
    .title{gap:10px; font-weight:600; font-size:14px; opacity:.9}

    /* -------------------- HERO (PRIMEIRA TELA) -------------------- */
    #hero{
      position:relative;
      min-height:100svh; /* certo no mobile */
      display:flex; align-items:flex-end; justify-content:center;
      padding: calc(56px + 10svh) var(--pad) calc(20svh);
      background:#000;
      overflow:hidden;
    }
    #hero .bg{
      position:absolute; inset:0; z-index:0;
      display:grid; place-items:center;
    }
    #heroImg{
      width:100%; height:100%;
      object-fit:cover;               /* DESKTOP */
      user-select:none; -webkit-user-drag:none;
      filter:none;                    /* sem escurecer */
    }

    /* ===== AJUSTE MOBILE: apenas SUBIR a imagem, sem mudar o tamanho ===== */
    @media (max-width: 768px){
      #hero{padding: calc(56px + 6svh) var(--pad) calc(18svh);}
      #heroImg{
        object-fit:contain;           /* como já estava */
        aspect-ratio:auto;            /* como já estava */
        object-position: center 70px; /* ajuste fino vertical */
      }
    }

    #hero .cta{
      position:relative; z-index:2;
      width:100%; max-width: min(780px, 92vw);
      display:flex; gap:14px; flex-wrap:wrap; justify-content:center;
    }
    .btn{
      appearance:none; border:0; border-radius:18px;
      padding:18px 28px; font-weight:800; letter-spacing:.02em;
      text-transform:uppercase; cursor:pointer;
      box-shadow: var(--shadow);
      transition: transform .08s ease, box-shadow .2s ease, opacity .2s ease, filter .2s ease;
      will-change: transform;
    }
    .btn:active{transform: translateY(1px); box-shadow: var(--shadow-soft);}
    .btn.primary{
      background:linear-gradient(180deg, var(--green) 0%, var(--green-700) 100%);
      color:#06261f;
    }
    .btn.secondary{ background:var(--white); color:#0a0d0c }
    .btn.full{ flex:1 1 320px; }

    /* -------------------- CONTEÚDOS (form, quiz, ranking) -------------------- */
    main{display:grid; gap:28px; padding:24px var(--pad) 48px; max-width:var(--maxw); margin:0 auto}
    .card{
      background:rgba(12,15,15,.72); backdrop-filter: blur(6px);
      border:1px solid rgba(255,255,255,.06);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding: min(28px, 3.2vw);
    }
    h2{margin:0 0 14px; font-size:22px}
    label{display:block; font-size:14px; margin:14px 0 6px; color:#cdd5d3}
    input[type="text"], input[type="tel"]{
      width:100%; padding:14px 16px; border-radius:12px; border:1px solid rgba(255,255,255,.08);
      background:#0b0f0e; color:#fff; outline:none;
    }
    .help{font-size:13px; color:#93a29f; margin-top:10px}
    .row{display:flex; gap:12px; flex-wrap:wrap}
    .row .btn{min-width:180px}

    /* Esconde as seções até acioná-las */
    #section-form, #section-quiz, #section-ranking{display:none}

    /* ------- Confirmação inline ------- */
    .confirm-box{
      margin-top:14px; padding:12px; border-radius:12px;
      border:1px solid rgba(255,255,255,.08); background:#0a0f0f;
    }
    .confirm-title{font-weight:800; margin-bottom:10px;}
  </style>
</head>
<body>

  <!-- topo -->
  <header>
    <div class="brand">
      <img src="img/logo.png" alt="Sobrenatural Church" onerror="this.style.display='none'">
    </div>
    <div class="title">Show do Crentão</div>
  </header>

  <!-- PRIMEIRA TELA -->
  <section id="hero">
    <div class="bg">
      <!-- a imagem será escolhida via JS dentre vários nomes possíveis -->
      <img id="heroImg" alt="Capa – Show do Crentão" class="hidden">
    </div>
    <div class="cta">
      <button id="btnStart" class="btn primary full">Iniciar</button>
      <button id="btnRanking" class="btn secondary full">Ranking</button>
    </div>
  </section>

  <!-- CONTEÚDOS -->
  <main>

    <!-- FORM PARTICIPANTE -->
    <section id="section-form" class="card">
      <h2>Dados do participante</h2>
      <label>Nome completo</label>
      <input id="nome" type="text" placeholder="Ex.: Maria Silva">

      <label>Telefone (com DDD)</label>
      <input id="fone" type="tel" placeholder="Ex.: (14) 99999-0000">

      <div class="help">Cada pessoa pode responder <strong>uma única vez</strong>.</div>

      <div class="row" style="margin-top:16px">
        <button id="btnEnviarDados" class="btn primary">Enviar</button>
      </div>
    </section>

    <!-- QUIZ -->
    <section id="section-quiz" class="card">
      <h2 id="quizPergunta">Pergunta</h2>
      <div id="quizOpcoes"></div>

      <!-- Confirmação inline -->
      <div id="confirmBox" class="confirm-box hidden">
        <div class="confirm-title">Você tem certeza da resposta?</div>
        <div class="row">
          <button id="btnConfirmar" class="btn primary">Confirmar</button>
          <button id="btnCancelar" class="btn secondary">Cancelar</button>
        </div>
      </div>

      <div class="row" style="margin-top:16px">
        <button id="btnResponder" class="btn primary">Enviar</button>
        <button id="btnLimpar" class="btn secondary">Limpar</button>
      </div>

      <audio id="fxCerteza"      src="audio/silvio-santos-voce-tem-certeza.mp3" preload="auto"></audio>
      <audio id="fxEntendeu"     src="audio/silvio-santos-voce-entendeu-a-pergunta.mp3" preload="auto"></audio>
      <audio id="fxEstaCerto"    src="audio/silvio-santos-esta-certo-disso.mp3" preload="auto"></audio>
      <audio id="fxQualResposta" src="audio/silvio-santos-qual-e-a-resposta-certa.mp3" preload="auto"></audio>
      <audio id="fxCertaResposta"src="audio/silvio-santos-certa-resposta.mp3" preload="auto"></audio>
      <audio id="fxErrou"        src="audio/faustao-errou.mp3" preload="auto"></audio>
      <audio id="fxAbertura"     src="audio/silvio-santos-abertura-show-do-milhao.mp3" preload="auto" loop></audio>
    </section>

    <!-- RANKING -->
    <section id="section-ranking" class="card">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
        <h2>Ranking</h2>
        <!-- Botão DEV aparece só quando URL tem #dev -->
        <button id="btnResetDev" class="btn secondary hidden" title="Apenas no modo dev">Limpar ranking (DEV)</button>
      </div>
      <div id="rankingLista" class="help">Sem participantes por enquanto.</div>
      <div class="row" style="margin-top:16px">
        <button id="btnVoltar" class="btn secondary">Voltar</button>
      </div>
    </section>

  </main>

<script>
(function(){
  /* --------------- Landing: escolher automaticamente a capa --------------- */
  const hero = document.getElementById('hero');
  const heroImg = document.getElementById('heroImg');

  const candidatos = [
    'img/cover.png','img/cover.jpg','img/cover.webp','img/capa.png','img/capa.jpg',
    'img/show-crentao-bg.png','img/show-crentao-bg.jpg',
    'img/logosc.png' // fallback
  ];

  function tenta(src){
    return new Promise(resolve=>{
      const i = new Image();
      i.onload = ()=>resolve(src);
      i.onerror = ()=>resolve(null);
      i.src = src + '?v=' + Date.now(); // evita cache travado
    });
  }

  (async function acharCapa(){
    let achou = null;
    for (const src of candidatos){
      achou = await tenta(src);
      if (achou) break;
    }
    if (achou){
      heroImg.src = achou;
      heroImg.classList.remove('hidden');
    } else {
      hero.style.background = '#000';
    }
  })();

  /* --------------- Navegação simples --------------- */
  const secForm = document.getElementById('section-form');
  const secQuiz = document.getElementById('section-quiz');
  const secRank = document.getElementById('section-ranking');

  const btnStart   = document.getElementById('btnStart');
  const btnRanking = document.getElementById('btnRanking');
  const btnVoltar  = document.getElementById('btnVoltar');

  const fxAbertura     = document.getElementById('fxAbertura');
  const fxCerteza      = document.getElementById('fxCerteza');
  const fxEntendeu     = document.getElementById('fxEntendeu');
  const fxEstaCerto    = document.getElementById('fxEstaCerto');
  const fxQualResposta = document.getElementById('fxQualResposta');
  const fxCerta        = document.getElementById('fxCertaResposta');
  const fxErrou        = document.getElementById('fxErrou');

  const $ = sel => document.querySelector(sel);
  const byId = id => document.getElementById(id);
  const canPlay = a => { try { a.currentTime=0; a.play().catch(()=>{}); } catch(e){} };
  const stop = a => { try { a.pause(); a.currentTime=0; } catch(e){} };

  function stopAllFx(){
    [fxAbertura,fxCerteza,fxEntendeu,fxEstaCerto,fxQualResposta,fxCerta,fxErrou]
      .forEach(stop);
  }

  function hideAll(){
    secForm.style.display = 'none';
    secQuiz.style.display = 'none';
    secRank.style.display = 'none';
  }

  // Ao clicar INICIAR: toca abertura até enviar dados
  btnStart.addEventListener('click', ()=>{
    canPlay(fxAbertura);
    hero.style.transition = 'transform .35s ease, opacity .35s ease';
    hero.style.transform  = 'translateY(-8px)';
    hero.style.opacity    = '0';
    setTimeout(()=>{
      hero.style.display='none';
      hideAll();
      secForm.style.display='block';
    }, 360);
  });

  // Botão Ranking direto
  btnRanking.addEventListener('click', ()=>{
    stopAllFx();
    hero.style.transition = 'transform .35s ease, opacity .35s ease';
    hero.style.transform  = 'translateY(-8px)';
    hero.style.opacity    = '0';
    setTimeout(()=>{
      hero.style.display='none';
      hideAll();
      secRank.style.display='block';
      renderRanking();
    }, 360);
  });

  btnVoltar.addEventListener('click', ()=>{
    hideAll();
    secForm.style.display='block';
  });

  /* --------------- Form + bloqueio 1x por telefone --------------- */
  const nome = document.getElementById('nome');
  const fone = document.getElementById('fone');
  const btnEnviarDados = document.getElementById('btnEnviarDados');

  const LS = {
    get: (k,def)=>{ try{ return JSON.parse(localStorage.getItem(k)) ?? def }catch(_){return def} },
    set: (k,v)=>localStorage.setItem(k, JSON.stringify(v)),
    del: (k)=>localStorage.removeItem(k)
  };

  let participanteAtual = null;

  btnEnviarDados.addEventListener('click', ()=>{
    const n = (nome.value||'').trim();
    const f = (fone.value||'').trim();
    if(!n || !f){ alert('Preencha nome e telefone.'); return; }
    const ja = LS.get('respondidos', {});
    if(ja[f]){ alert('Este telefone já respondeu.'); return; }
    // salva e segue para o quiz
    ja[f] = { nome:n, quando: Date.now() };
    LS.set('respondidos', ja);
    participanteAtual = { nome:n, fone:f, pontos:0 };

    // PARA a música de abertura ao enviar os dados
    stop(fxAbertura);

    iniciarQuiz();
  });

  /* --------------- Quiz (uma por vez) --------------- */
  const perguntas = [
    {
      enunciado: "O que é fé genuína segundo o estudo?",
      opcoes: [
        "Fé baseada no testemunho de outras pessoas.",
        "Fé emocional despertada em um culto.",
        "Fé verdadeira e pessoal, que cresce com exercício.",
        "Fé herdada de familiares."
      ],
      certa: 2
    },
    {
      enunciado: "Qual foi o primeiro aspecto importante na vida de Abraão?",
      opcoes: ["Obediência imediata","Caridade","Riqueza","Fama"],
      certa: 0
    },
    {
      enunciado: "A obediência, segundo a aula, é sobretudo…",
      opcoes: [
        "um ato de submissão cega.",
        "uma expressão de amor e confiança em Deus.",
        "uma tradição da igreja.",
        "uma estratégia para evitar problemas."
      ],
      certa: 1
    },
    {
      enunciado: "Qual é a característica primordial do cristão destacada na aula?",
      opcoes: ["Popularidade","Prosperidade","Perseverança","Carisma"],
      certa: 2
    }
  ];

  let idx = 0, escolha = null;

  const elPerg     = document.getElementById('quizPergunta');
  const elOps      = document.getElementById('quizOpcoes');
  const btnResp    = document.getElementById('btnResponder');
  const btnLimpar  = document.getElementById('btnLimpar');
  const confirmBox = document.getElementById('confirmBox');
  const btnConf    = document.getElementById('btnConfirmar');
  const btnCanc    = document.getElementById('btnCancelar');

  function iniciarQuiz(){
    hideAll();
    secQuiz.style.display='block';
    idx = 0; escolha = null;
    canPlay(fxEntendeu); // "Você entendeu a pergunta?"
    renderPergunta();
  }

  function renderPergunta(){
    const p = perguntas[idx];
    elPerg.textContent = `Pergunta ${idx+1} de ${perguntas.length}: ${p.enunciado}`;
    elOps.innerHTML = '';
    confirmBox.classList.add('hidden');

    p.opcoes.forEach((txt,i)=>{
      const id = `op${idx}_${i}`;
      const li = document.createElement('label');
      li.style.display='flex'; li.style.gap='10px'; li.style.alignItems='center'; li.style.margin='10px 0';
      li.innerHTML = `<input type="radio" name="op" id="${id}" value="${i}" /> <span>${txt}</span>`;
      elOps.appendChild(li);
    });
    elOps.querySelectorAll('input[name=op]').forEach(r=>{
      r.addEventListener('change', ()=>{ escolha = +r.value; });
    });
  }

  // Botão ENVIAR → mostra confirmação
  btnResp.addEventListener('click', ()=>{
    if(escolha===null){ canPlay(fxCerteza); return; } // reaproveito "tem certeza?" como aviso de seleção faltante
    // Mostra a confirmação e toca "Você tem certeza?"
    confirmBox.classList.remove('hidden');
    canPlay(fxCerteza);
  });

  // CONFIRMAR → toca "Qual é a resposta certa?" e avalia
  btnConf.addEventListener('click', ()=>{
    confirmBox.classList.add('hidden');
    canPlay(fxQualResposta);

    setTimeout(()=>{
      const p = perguntas[idx];
      const ok = (escolha===p.certa);
      if(ok){ participanteAtual.pontos++; canPlay(fxCerta); }
      else { canPlay(fxErrou); }

      idx++;
      escolha=null;
      if(idx<perguntas.length){
        // pequena pausa antes da próxima
        setTimeout(()=>{ canPlay(fxEntendeu); renderPergunta(); }, 700);
      } else {
        finalizar();
      }
    }, 900);
  });

  // CANCELAR → fecha confirmação sem avaliar
  btnCanc.addEventListener('click', ()=>{
    confirmBox.classList.add('hidden');
    // opcional: "Você está certo disso?" ao cancelar (mantive silencioso)
  });

  btnLimpar.addEventListener('click', ()=>{
    elOps.querySelectorAll('input[name=op]').forEach(r=>r.checked=false);
    escolha=null;
  });

  /* --------------- Finalização + Ranking --------------- */
  function finalizar(){
    const rank = LS.get('ranking', []);
    rank.push({ nome: participanteAtual.nome, fone: participanteAtual.fone, pontos: participanteAtual.pontos, quando: Date.now() });
    // ordena: maior pontuação primeiro, empate pelo mais cedo
    rank.sort((a,b)=> b.pontos - a.pontos || a.quando - b.quando);
    LS.set('ranking', rank);

    hideAll();
    secRank.style.display='block';
    renderRanking();
  }

  function renderRanking(){
    const rank = LS.get('ranking', []);
    const box = document.getElementById('rankingLista');
    if(!rank.length){ box.textContent = 'Sem participantes por enquanto.'; return; }
    const linhas = rank.map((r,i)=> `${i+1}. ${r.nome} — ${r.fone} — ${r.pontos} ponto(s)`);
    box.innerHTML = linhas.map(l=>`<div style="padding:6px 0;border-bottom:1px solid rgba(255,255,255,.06)">${l}</div>`).join('');
  }

  /* --------------- Modo DEV: reset do ranking (oculto) --------------- */
  const btnResetDev = document.getElementById('btnResetDev');
  if (location.hash === '#dev') {
    btnResetDev.classList.remove('hidden');
    btnResetDev.addEventListener('click', ()=>{
      if (confirm('Apagar todos os resultados do ranking neste navegador?')) {
        LS.del('ranking');
        LS.del('respondidos');
        renderRanking();
        alert('Ranking limpo (apenas neste navegador).');
      }
    });
  }

})();
</script>
</body>
</html>

